<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Физичитариум - Перенаправление</title>
    <script type="text/javascript">
      // Перенаправляем все запросы на index.html
      // Это необходимо для корректной работы SPA на GitHub Pages
      const pathSegmentsToKeep = 1
      const location = window.location

      // Проверяем, если URL уже содержит параметры p= и q=, не добавляем их снова
      if (location.search && location.search.indexOf('p=') !== -1) {
        // Если URL уже обработан, просто перенаправляем на главную
        window.location.href = `${location.protocol}//${location.hostname}${location.port ? ':' + location.port : ''}/physics/`
      } else {
        // Формируем путь перенаправления только для необработанных URL
        const path = location.pathname
          .slice(1)
          .split('/')
          .slice(pathSegmentsToKeep)
          .join('/')
          .replace(/&/g, '~and~')
        const query = location.search ? `&q=${location.search.slice(1).replace(/&/g, '~and~')}` : ''

        const redirectUrl = `${location.protocol}//${location.hostname}${location.port ? ':' + location.port : ''}/physics/?p=/${path}${query}${location.hash}`

        window.location.href = redirectUrl
      }
    </script>
  </head>
  <body>
    <h1>Перенаправление...</h1>
    <p>
      Если вы не были перенаправлены автоматически, пожалуйста,
      <a href="/physics/">нажмите здесь</a>.
    </p>
  </body>
</html>
